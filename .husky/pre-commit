#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” NeXify AI MASTER - Quality Assurance Check"

# Quality Gates
echo "ğŸ“‹ TypeScript Check..."
npm run type-check || exit 1

echo "ğŸ“‹ ESLint Check..."
npm run lint || exit 1

echo "ğŸ“‹ Prettier Check..."
npm run format:check || exit 1

echo "ğŸ“‹ Unit Tests (Changed Files)..."
npm run test:unit:changed || exit 1

# RLS Coverage Check (Critical Security Check)
echo "ğŸ›¡ï¸ RLS Coverage Check..."
if npm run check:rls 2>/dev/null; then
  echo "âœ… RLS Coverage OK"
else
  echo "âš ï¸ RLS Check skipped (Supabase credentials may not be set in local env)"
fi

echo "âœ… All Quality Gates Passed!"
