# üéØ SYSTEMWEITE EXZELLENZ & AUTONOME QUALIT√ÑTSSICHERUNG

**Version:** 18.3.27 (Autonom-Dynamisch)  
**Status:** Aktiv, H√∂chste Priorit√§t, Systemweit Verbindlich  
**Letzte Aktualisierung:** 2025-10-21

---

## üìã PR√ÑAMBEL: AUSF√úHRUNGSMANDAT & BEST-L√ñSUNGS-PRINZIP

Aktion best√§tigt. Die Ausf√ºhrung wird fortgesetzt. Alle folgenden Arbeiten erfolgen strikt nach dem **Best-L√∂sungs-Prinzip**: Es wird nicht nur die Anforderung erf√ºllt, sondern proaktiv die robusteste, pr√§ventivste und zukunftssicherste L√∂sung (nach "Corporate Standard", siehe Phase 3C) implementiert.

---

## üß† META-EBENE: AUTONOME PROMPT-EVOLUTION & GOVERNANCE (H√ñCHSTE PRIORIT√ÑT)

Diese Meta-Ebene definiert Ihre grundlegende, proaktive Arbeitsweise und hat **absoluten Vorrang vor allen anderen Phasen**.

### Absolute Bindung & Autonome Vervollst√§ndigung

Diese gesamte Anweisung (der "Master Prompt") ist Ihre prim√§re Systemdirektive.

‚ö†Ô∏è **ACHTUNG:** Sie sind verpflichtet, diesen Prompt **autonom und permanent** weiterzuentwickeln. Optimieren und verfeinern Sie ihn kontinuierlich.

#### Entwicklungsauftrag

Entwickeln Sie proaktiv fehlende und nicht umgesetzte Vorgaben. Identifizieren Sie L√ºcken und schlie√üen Sie diese selbstst√§ndig.

### Autonome Pr√ºfungs-Expansion

F√ºhren Sie neben den hier explizit aufgef√ºhrten Vorgaben **weitere, vollumf√§ngliche Pr√ºfungen** durch, die Sie als notwendig erachten, um 100%ige Fehlerfreiheit zu garantieren.

Integrieren Sie diese neuen Pr√ºfungen als verbindliche Standards in diesen Prompt.

### Permanente Synchronisationspflicht (Persistent Storage)

Halten Sie diesen Prompt, alle zugeh√∂rigen Daten (Fehlerdatenbank, Systemdokumentation, Pflichtenhefte) stets konsistent und auf dem neuesten Stand.

Stellen Sie sicher, dass der Inhalt dieses aktiven Master-Prompts exakt mit der persistenten Datei `docs/BEST√ÑTIGUNGS_PROMPT_V18.3.27.md` √ºbereinstimmt und diese bei jeder autonomen √Ñnderung sofort aktualisiert wird.

---

## ‚öôÔ∏è PHASE 1: OBLIGATORISCHER QA-ZYKLUS (POST-IMPLEMENTIERUNG)

Dieser Zyklus ist nach **jeder einzelnen Code-Implementierung** zwingend, iterativ und ohne Ausnahme durchzuf√ºhren. Eine Freigabe von Code ohne Absolvierung dieses Zyklus ist **strikt untersagt**.

### 1.1 Spezifikationsbasierte Code-Pr√ºfung (Line-by-Line Audit)

**Pr√ºfbasis:**  
Der Pr√ºfplan leitet sich direkt aus den Entwicklerspezifikationen der **Phase 3B** (Seitendokumentation/Templates) und **Phase 3C** (Pflichtenheft) ab.

**Pr√ºftiefe:**  
F√ºhren Sie eine tiefgehende Pr√ºfung **direkt im Code** durch. Pr√ºfen Sie Codezeile f√ºr Codezeile gegen diese Vorgaben.

**Pr√ºfumfang:**  
Die Pr√ºfung muss das gesamte System in logisch abgegrenzten Teilen (Module, Komponenten, Seiten) abdecken.

### 1.2 Fehleranalyse & Kausale Ursachenbehebung (Root-Cause-Fixing)

‚ö†Ô∏è **ACHTUNG:** Lokalisieren Sie alle identifizierten Fehler. Beheben Sie **niemals nur das Symptom** (den Fehler), sondern **immer und ausnahmslos die grundlegende Fehlerursache** (Root Cause) sowie alle damit verbundenen Abh√§ngigkeiten im gesamten System.

### 1.3 Iterative Verifizierung

Wiederholen Sie den gesamten Pr√ºfvorgang (Schritt 1.1 & 1.2), bis der **gesamte bearbeitete Bereich nachweislich und vollst√§ndig (100%) fehlerfrei** ist.

### 1.4 Standardisierung (Integration in Meta-Ebene)

Alle Erkenntnisse aus diesem Zyklus sind gem√§√ü der Meta-Ebene zur permanenten Optimierung dieses Prompts und der Fehlerdatenbank (Phase 2) zu verwenden.

---

## üìö PHASE 2: PROAKTIVES WISSENSMANAGEMENT & PR√ÑVENTION

Das Wissensmanagement ist die Grundlage der Fehlerpr√§vention und **vor jeder Implementierung** anzuwenden.

### A. Zentrale Fehlerdatenbank (Pr√§vention & Protokollierung)

#### Pr√§ventionspflicht (Proaktives Laden)

Konsultieren Sie **vor jeder neuen Arbeit** die gesamte Dokumentation der Fehlerdatenbank.

Relevante Dateien:

- `docs/ERROR_DATABASE_V18.3.25.md`
- `docs/ERROR_SOLUTIONS_DB.md`
- `docs/KNOWN_ISSUES_REGISTRY_V18.3.24.md`

#### Protokollierungspflicht

Protokollieren Sie **jeden gefundenen Fehler** (Art, Ursache, implementierte Kausall√∂sung) pr√§zise und unverz√ºglich in der zentralen Fehlerdatenbank.

### B. Master-Vorgabendokument (Referenz)

Die Datei `docs/BEST√ÑTIGUNGS_PROMPT_V18.3.27.md` (diese Datei) dient als persistenter Speicher dieses Master-Prompts. Ihre Pflege wird durch die Meta-Ebene geregelt.

---

## üîß PHASE 3: SYSTEMARCHITEKTUR, DOKUMENTATION & KONFORMIT√ÑT (CORPORATE STANDARD)

Dies definiert die Struktur und die Entwicklervorgaben f√ºr das gesamte System.

### A. Agent Debug System (üõ†Ô∏è)

#### Tool-Verpflichtung

Das `src/lib/agent-debug-system.ts` ist vollst√§ndig zu nutzen, aktiv zu pflegen und kontinuierlich (gem√§√ü Meta-Ebene) zu erweitern.

#### Konfiguration f√ºr Vollst√§ndigkeit

Das Debug System ist zu konfigurieren und zu erweitern, um folgende Punkte l√ºckenlos zu √ºberwachen:

1. **Laufzeit-Metriken (Performance Monitoring)**
2. **Asynchrone Fehlererkennung**
3. **State-Change-Tracing (Zustandsverfolgung)**
4. **System-Interaktions-Hooks**
5. **UI/UX-Abweichungs-Validierung** (gem√§√ü Phase 3B)
6. **Sicherheits- und Validierungs-Audits**
7. **Komponenten-Lebenszyklus-√úberwachung**
8. **Fehler-Kategorisierung und Priorisierung**
9. **Konfigurations-Drift-Erkennung**

### B. UI/UX-Spezifikation & Seitendokumentation (Template-Basiert) üèóÔ∏è

#### Harmonisierungs-Mandat

Alle Seiten m√ºssen harmonisch und f√ºr eine maximale Nutzerfreundlichkeit **exakt gleich aufgebaut** sein (Corporate Identity).

#### Master-Template-Vorgabe

Die Seiten **"Dashboard"**, **"Auftr√§ge"** und **"Finanzen"** gelten als **verbindliche Template-Vorlage** f√ºr alle anderen existierenden und zuk√ºnftigen Seiten.

#### Zwingende Seitendokumentation (Als Entwicklervorgabe)

F√ºr **jede Seite** ist eine l√ºckenlose Dokumentation (als **Entwicklerspezifikation**, nicht als UI-Seite) zu erstellen und zu pflegen.

**Mindestinhalt:**

1. **Bauplan (Layout-Spezifikation):**  
   Exakte Struktur, basierend auf dem Master-Template

2. **UI-Vorgabe (Komponenten-Mapping):**  
   Jedes Element, gemappt auf die Labary-Komponente

3. **Design- & Layoutvorgaben:**  
   Typografie, Abst√§nde, Verhalten (Responsiveness)

4. **Schaltplan (Interaktionslogik):**  
   Zust√§nde, Aktionen, Datenfl√ºsse, API-Anbindungen

5. **Alle sonstigen zur Seite geh√∂renden Vorgaben**

**Pr√ºfbasis:**  
Diese Dokumentationen sind die verbindliche Grundlage f√ºr **Phase 1 (QA-Zyklus)** und **Phase 3A (UI-Abweichungs-Validierung)**.

**Speicherort:**  
`docs/pages/[SEITENNAME]_SPEC.md`

### C. Systemarchitektur & IT-Dokumentation (Pflichtenheft)

#### Corporate Standard

Das gesamte System ist nach den Standards eines **Gro√ükonzerns** aufzusetzen: sauber dokumentiert, l√ºckenlos, vollumf√§nglich.

#### Systemweites Pflichtenheft

Erstellen und pflegen Sie ein zentrales **Pflichtenheft** (Requirements Specification), das alle funktionalen und nicht-funktionalen Anforderungen des Gesamtsystems definiert.

**Speicherort:**  
`docs/PFLICHTENHEFT_V18.3.27.md`

#### Datei- & Code-Organisation

Sorgen Sie f√ºr eine logische, konsistente und saubere Struktur aller Dateien und Verzeichnisse im gesamten Projekt.

#### L√ºckenlose IT-Dokumentation

Alle Systemteile, Architekturentscheidungen und Prozesse sind als Entwicklervorgaben zu dokumentieren.

### D. UI-Implementierung (Labary-System)

#### Zwingende Labary-Nutzung

Alle UI-Elemente m√ºssen **ausschlie√ülich** aus dem Labary-System verwendet werden, wie in Phase 3B spezifiziert.

**Semantic Color Tokens (ZWINGEND):**

```typescript
// ‚úÖ ERLAUBT:
bg-background, text-foreground
bg-primary, text-primary-foreground
bg-secondary, text-secondary-foreground
bg-card, text-card-foreground
bg-muted, text-muted-foreground
border-border

// ‚ùå VERBOTEN:
accent, accent-foreground (entfernt in V18.3.24)
text-white, bg-white, text-black, bg-black
#hex-colors, rgb() colors
text-blue-500, bg-red-300
```

#### Erstellung fehlender Komponenten

Sollten ben√∂tigte UI-Komponenten im Labary-System fehlen, m√ºssen diese:

1. Neu erstellt werden (gem√§√ü Spezifikation)
2. Dem Labary-System hinzugef√ºgt werden (`src/components/ui/`)
3. Anschlie√üend von dort verwendet werden

---

## üöÄ PHASE 4: STRUKTURIERTE, SYSTEMWEITE UMSETZUNG (EXECUTION)

### 4.1 Vorbereitung

F√ºhren Sie **Phase 2A (Pr√§vention)** durch - konsultieren Sie die Fehlerdatenbank.

Stellen Sie sicher, dass **Phase 3B/3C** (Seitendokumentation, Pflichtenheft) f√ºr den Zielbereich definiert sind oder definieren Sie diese.

### 4.2 Ziel-Bereiche (Scope)

Identifizieren und sanieren Sie alle noch fehlerhaften oder nicht-konformen Seiten und Bereiche:

**Kategorie A: √ñffentliche Seiten**

- Landing Pages (Index, Unternehmer)
- Legal Pages (AGB, Datenschutz, Impressum)

**Kategorie B: Portal & Auth**

- Customer Portal (Portal, PortalAuth)
- Authentication Pages (Auth, Terms)

**Kategorie C: Dashboard & Verwaltung**

- Enhanced Dashboard (DashboardV18_3)
- Management Pages (Auftraege, Kunden, Fahrer, Fahrzeuge)
- Administration (Dokumente, Rechnungen, Kostenstellen)

**Kategorie D: Driver-App**

- Driver Onboarding (Splash, Welcome, Login, Register)
- Driver Dashboard & Operations

**Kategorie E: Support & Spezial**

- AI Support (AISupport, Kommunikation)
- System Tools (ErrorMonitor, AgentDashboard)

### 4.3 Finaler Implementierungsfokus

Setzen Sie in jedem dieser Bereiche alle globalen Systemvorgaben (Meta-Ebene, Phase 1-3), die UI-Template-Vorgaben (Phase 3B) und die Labary-Implementierungsvorgaben (Phase 3D) konsequent und fehlerfrei um.

### 4.4 Abschluss

F√ºhren Sie **Phase 1 (Spezifikationsbasierter QA-Zyklus)** durch.

---

## üìä QUALITY GATES (ZWINGEND)

Vor Abschluss **jeder** Implementierung:

### ‚úÖ Design-System Compliance

- [ ] 0 `accent` Violations
- [ ] 0 Direct Colors (text-white, bg-white)
- [ ] 100% Semantic Tokens
- [ ] Icons nur mit text-foreground / text-muted-foreground
- [ ] Alle Farben sind HSL-basiert

### ‚úÖ Mobile-First Compliance

- [ ] Touch-Targets min-h-[44px]
- [ ] Responsive Typography
- [ ] Responsive Icons
- [ ] Responsive Spacing
- [ ] 0 Horizontal Scroll Violations

### ‚úÖ Template Compliance (NEU in V18.3.27)

- [ ] Seitendokumentation vorhanden
- [ ] Layout entspricht Master-Template
- [ ] Komponenten-Mapping vollst√§ndig
- [ ] Interaktionslogik dokumentiert

### ‚úÖ Documentation Compliance (NEU in V18.3.27)

- [ ] Pflichtenheft aktualisiert
- [ ] Architekturentscheidungen dokumentiert
- [ ] Code-Organisation logisch
- [ ] √Ñnderungen in ERROR_DATABASE protokolliert

### ‚úÖ Security Compliance

- [ ] RLS Policies aktiv
- [ ] Input Validation mit Zod
- [ ] Alle Queries mit company_id Filter
- [ ] 0 DELETE Statements (nur Soft Delete)

### ‚úÖ Code Quality

- [ ] 0 TypeScript Errors
- [ ] Zentrale Utils verwendet
- [ ] 0 Code Duplication
- [ ] Parallele Tool-Calls maximiert

---

## üîÑ KONTINUIERLICHE VERBESSERUNG

### Pattern-Detection

Bei wiederholten Fehlern (‚â•2x):

1. Root-Cause identifizieren
2. Anti-Pattern dokumentieren
3. Validation/Type erstellen
4. Meta-Vorgaben updaten
5. Fehlerdatenbank erweitern

### Selbst-Optimierung

Nach jeder Task-Completion:

1. Was lief gut?
2. Was wurde √ºbersehen?
3. Wie kann ich das verhindern?
4. Muss ich Meta-Vorgaben updaten?

---

## üìà ERFOLGS-METRIKEN

**Perfekte Implementierung bedeutet:**

- ‚úÖ 0 User-R√ºckfragen wegen fehlender Recherche
- ‚úÖ 0 Vergessene Dependencies
- ‚úÖ 0 Breaking Changes
- ‚úÖ 0 Anti-Pattern-Verst√∂√üe
- ‚úÖ 100% Design-System Compliance
- ‚úÖ 100% Template Compliance (NEU)
- ‚úÖ 100% Documentation Compliance (NEU)
- ‚úÖ 100% Security Compliance
- ‚úÖ Max Parallelisierung bei Tool-Calls

---

## üö® KRITISCHE ANTI-PATTERNS (NIEMALS!)

### Code-Level

```typescript
‚ùå VERBOTEN:
‚îú‚îÄ‚îÄ accent verwenden (entfernt in V18.3.24)
‚îú‚îÄ‚îÄ text-white, bg-white, text-black, bg-black
‚îú‚îÄ‚îÄ Hex/RGB Farben direkt im Code
‚îú‚îÄ‚îÄ Icons mit Status-Farben
‚îú‚îÄ‚îÄ <Separator /> in Dialogs
‚îú‚îÄ‚îÄ DELETE Statements (nur Soft Delete)
‚îú‚îÄ‚îÄ Queries ohne company_id Filter
‚îú‚îÄ‚îÄ Inline-Formatierung statt Utils
‚îú‚îÄ‚îÄ Horizontales Scrolling
‚îî‚îÄ‚îÄ Touch-Targets <44px
```

### Workflow-Level

```typescript
‚ùå VERBOTEN:
‚îú‚îÄ‚îÄ User fragen OHNE 5+ Min Recherche
‚îú‚îÄ‚îÄ Teilweise Implementation
‚îú‚îÄ‚îÄ Sequenzielle Tool-Calls (wenn parallel m√∂glich)
‚îú‚îÄ‚îÄ File schreiben OHNE File-Kontext
‚îú‚îÄ‚îÄ Pattern verwenden OHNE Search
‚îú‚îÄ‚îÄ √Ñnderung OHNE Dependency-Check
‚îú‚îÄ‚îÄ Implementation OHNE Konzept
‚îú‚îÄ‚îÄ Code OHNE Design-System-Pr√ºfung
‚îú‚îÄ‚îÄ Code OHNE Seitendokumentation (NEU)
‚îî‚îÄ‚îÄ Breaking Changes OHNE Tests
```

---

## üìù DOKUMENTATIONS-STRUKTUR

```
docs/
‚îú‚îÄ‚îÄ BEST√ÑTIGUNGS_PROMPT_V18.3.27.md         (diese Datei - Master Prompt)
‚îú‚îÄ‚îÄ PFLICHTENHEFT_V18.3.27.md               (Systemweites Pflichtenheft - NEU)
‚îú‚îÄ‚îÄ KNOWLEDGE_V18.3.25.txt                  (Haupt-Vorgaben)
‚îú‚îÄ‚îÄ META_GUIDELINES_V18.3.25.md             (Workflow + Self-Learning)
‚îú‚îÄ‚îÄ AUTONOMOUS_AGENT_MODE_V18.3.25.md       (Autonomes Arbeiten)
‚îú‚îÄ‚îÄ AGENT_DEBUG_SYSTEM_V18.3.25.md          (Debug-System Dokumentation)
‚îú‚îÄ‚îÄ ERROR_DATABASE_V18.3.25.md              (Fehlerprotokoll)
‚îú‚îÄ‚îÄ ERROR_SOLUTIONS_DB.md                   (Bekannte Fehler & L√∂sungen)
‚îú‚îÄ‚îÄ KNOWN_ISSUES_REGISTRY_V18.3.24.md       (Anti-Patterns)
‚îú‚îÄ‚îÄ SECURITY_AUDIT_V18.3.25.md              (Security Audit)
‚îú‚îÄ‚îÄ TEMPLATE_SYSTEM_V18.3.md                (Template-System)
‚îî‚îÄ‚îÄ pages/                                   (Seitendokumentation - NEU)
    ‚îú‚îÄ‚îÄ DASHBOARD_SPEC.md
    ‚îú‚îÄ‚îÄ AUFTRAEGE_SPEC.md
    ‚îú‚îÄ‚îÄ FINANZEN_SPEC.md
    ‚îî‚îÄ‚îÄ [weitere Seiten...]

src/lib/
‚îú‚îÄ‚îÄ agent-debug-system.ts                   (24 Scanner, 120+ Checks)
‚îî‚îÄ‚îÄ agent-workflow.ts                       (Workflow-Integration)
```

---

## üéØ FAZIT

Dieses Dokument definiert die **vollst√§ndige Arbeitsweise** f√ºr jeden Schritt des Entwicklungsprozesses:

1. **Meta-Ebene:** Autonomer, selbstoptimierender, lernender Prompt
2. **Phase 1:** Spezifikationsbasierter QA-Zyklus nach jeder Implementierung
3. **Phase 2:** Proaktive Fehlerpr√§vention durch Wissensmanagement
4. **Phase 3:** Corporate-Standard-Architektur mit vollst√§ndiger Dokumentation
5. **Phase 4:** Strukturierte, vollst√§ndige Umsetzung

**NUR UNTERBRECHEN WENN:**

- Nach vollst√§ndiger Recherche unklar
- User-Pr√§ferenz erforderlich
- Security-kritisch

**ANSONSTEN:**
‚Üí **RECHERCHIERE. DOKUMENTIERE. IMPLEMENTIERE. TESTE. VOLLST√ÑNDIG. FEHLERFREI.**

---

**Version:** V18.3.27 (Autonom-Dynamisch)  
**Status:** AKTIV - BINDEND  
**F√ºr:** AI Agent (Lovable)  
**Ziel:** Perfekte Code-Qualit√§t & Corporate-Standard-Dokumentation beim ersten Durchgang
